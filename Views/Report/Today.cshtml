@{
    ViewData["Title"] = "B√°o c√°o v·∫≠n h√†nh h√¥m nay";
}

<div class="report-page container my-4">
    <!-- Header -->
    <div class="report-header d-flex flex-wrap align-items-center justify-content-between gap-3 mb-3">
        <div class="d-flex align-items-start gap-3">
            <div class="report-icon">
                <span>üì¶</span>
            </div>
            <div>
                <h3 class="m-0 report-title">B√°o c√°o v·∫≠n h√†nh h√¥m nay</h3>
                <div class="report-sub">
                    <span class="me-2">üïí</span>
                    <span class="text-muted">C·∫≠p nh·∫≠t l√∫c <b>@ViewBag.LastUpdated</b></span>
                </div>
            </div>
        </div>

        <div class="report-pill">
            <span class="dot"></span>
            <span>D·ªØ li·ªáu theo ng√†y</span>
        </div>
    </div>

    <!-- KPI Cards -->
    <div class="row g-3">
        <!-- KH√ÇU L·∫§Y -->
        <div class="col-lg-4">
            <div class="kpi-card kpi-success h-100">
                <div class="kpi-top">
                    <div class="kpi-head">
                        <div class="kpi-badge">üì¨</div>
                        <div>
                            <div class="kpi-title">Kh√¢u l·∫•y</div>
                            <div class="kpi-desc">T·ªïng quan t·ªìn & k·∫øt qu·∫£ x·ª≠ l√Ω</div>
                        </div>
                    </div>
                    <div class="kpi-chip">Pickup</div>
                </div>

                <div class="kpi-body">
                    <div class="kpi-row">
                        <div class="kpi-label">T·ªìn ƒë·∫ßu ng√†y</div>
                        <div class="kpi-value">@ViewBag.TotalBefore</div>
                    </div>
                    <div class="kpi-row">
                        <div class="kpi-label">T·ªìn hi·ªán t·∫°i</div>
                        <div class="kpi-value">@(ViewBag.TotalBefore + ViewBag.TotalToday)</div>
                    </div>

                    <div class="kpi-divider"></div>

                    <div class="kpi-grid">
                        <div class="kpi-mini">
                            <div class="kpi-mini-label">L·∫•y th√†nh c√¥ng</div>
                            <div class="kpi-mini-value">@ViewBag.Done</div>
                        </div>
                        <div class="kpi-mini">
                            <div class="kpi-mini-label">H·ªßy l·∫•y</div>
                            <div class="kpi-mini-value">@ViewBag.Cancelled</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- KH√ÇU GIAO -->
        <div class="col-lg-4">
            <div class="kpi-card kpi-primary h-100">
                <div class="kpi-top">
                    <div class="kpi-head">
                        <div class="kpi-badge">üöö</div>
                        <div>
                            <div class="kpi-title">Kh√¢u giao</div>
                            <div class="kpi-desc">Theo d√µi giao trong ng√†y</div>
                        </div>
                    </div>
                    <div class="kpi-chip">Delivery</div>
                </div>

                <div class="kpi-body">
                    <div class="kpi-row">
                        <div class="kpi-label">T·ªïng ƒë∆°n giao h√¥m nay</div>
                        <div class="kpi-value">@ViewBag.TotalToday</div>
                    </div>
                    <div class="kpi-row">
                        <div class="kpi-label">ƒêang giao</div>
                        <div class="kpi-value">@ViewBag.Shipping</div>
                    </div>

                    <div class="kpi-divider"></div>

                    <div class="kpi-grid">
                        <div class="kpi-mini">
                            <div class="kpi-mini-label">Giao th√†nh c√¥ng</div>
                            <div class="kpi-mini-value">@ViewBag.Done</div>
                        </div>
                        <div class="kpi-mini">
                            <div class="kpi-mini-label">H·ªßy giao</div>
                            <div class="kpi-mini-value">@ViewBag.Cancelled</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- KH√ÇU HO√ÄN -->
        <div class="col-lg-4">
            <div class="kpi-card kpi-warning h-100">
                <div class="kpi-top">
                    <div class="kpi-head">
                        <div class="kpi-badge">‚Ü©Ô∏è</div>
                        <div>
                            <div class="kpi-title">Kh√¢u ho√†n</div>
                            <div class="kpi-desc">Theo d√µi tr·∫°ng th√°i ho√†n</div>
                        </div>
                    </div>
                    <div class="kpi-chip">Return</div>
                </div>

                <div class="kpi-body">
                    <div class="kpi-row">
                        <div class="kpi-label">T·ªìn ho√†n ƒë·∫ßu ng√†y</div>
                        <div class="kpi-value">0</div>
                    </div>
                    <div class="kpi-row">
                        <div class="kpi-label">T·ªìn ho√†n hi·ªán t·∫°i</div>
                        <div class="kpi-value">0</div>
                    </div>

                    <div class="kpi-divider"></div>

                    <div class="kpi-grid">
                        <div class="kpi-mini">
                            <div class="kpi-mini-label">Ho√†n th√†nh c√¥ng</div>
                            <div class="kpi-mini-value">0</div>
                        </div>
                        <div class="kpi-mini">
                            <div class="kpi-mini-label">H·ªßy ho√†n</div>
                            <div class="kpi-mini-value">0</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chart + Settings -->
    <div class="row g-3 mt-2">
        <div class="col-lg-8">
            <div class="panel-card h-100">
                <div class="panel-head">
                    <div>
                        <div class="panel-title">T·ª∑ l·ªá tr·∫°ng th√°i ƒë∆°n h√†ng h√¥m nay</div>
                        <div class="panel-sub">Bi·ªÉu ƒë·ªì t·ªïng h·ª£p theo c√°c tr·∫°ng th√°i ch√≠nh</div>
                    </div>
                </div>

                <div class="panel-body">
                    <canvas id="statusChart" style="max-height: 360px;"></canvas>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="panel-card h-100">
                <div class="panel-head">
                    <div>
                        <div class="panel-title">T√πy ch·ªçn nh·∫≠n b√°o c√°o</div>
                        <div class="panel-sub">B·∫≠t/t·∫Øt email b√°o c√°o v·∫≠n h√†nh</div>
                    </div>
                </div>

                <div class="panel-body">
                    <div class="form-check form-switch report-switch">
                        <input class="form-check-input" type="checkbox" id="emailSwitch">
                        <label class="form-check-label" for="emailSwitch">
                            Nh·∫≠n email b√°o c√°o v·∫≠n h√†nh
                        </label>
                    </div>

                    <div class="hint mt-3">
                        G·ª£i √Ω: B·∫°n c√≥ th·ªÉ b·∫≠t ƒë·ªÉ nh·∫≠n b√°o c√°o cu·ªëi ng√†y, ph·ª•c v·ª• ƒë·ªëi so√°t v√† theo d√µi KPI.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const ctx = document.getElementById('statusChart').getContext('2d');
        const data = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(ViewBag.ChartData));

        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Ch·ªù x·ª≠ l√Ω', 'ƒêang giao', 'Ho√†n t·∫•t', 'ƒê√£ h·ªßy'],
                datasets: [{
                    label: 'ƒê∆°n h√†ng h√¥m nay',
                    data: data,
                    backgroundColor: [
                        '#17a2b8',
                        '#ffc107',
                        '#28a745',
                        '#dc3545'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'bottom' },
                    title: { display: true, text: 'T·ª∑ l·ªá tr·∫°ng th√°i ƒë∆°n h√†ng h√¥m nay' }
                }
            }
        });
    </script>
}

<style>
    /* ===== Page base ===== */
    .report-page {
        --bg: #ffffff;
        --text: #111827;
        --muted: #6b7280;
        --card: #ffffff;
        --border: rgba(17, 24, 39, 0.08);
        --shadow: 0 10px 30px rgba(17, 24, 39, 0.08);
        --shadow2: 0 14px 40px rgba(17, 24, 39, 0.10);
        color: var(--text);
        font-family: "Segoe UI", system-ui, -apple-system, Arial, sans-serif;
    }

    /* ===== Header ===== */
    .report-header {
        padding: 14px 16px;
        background: linear-gradient(180deg, rgba(220, 53, 69, 0.08), rgba(220, 53, 69, 0.02));
        border: 1px solid var(--border);
        border-radius: 16px;
        box-shadow: var(--shadow);
    }

    .report-icon {
        width: 44px;
        height: 44px;
        border-radius: 14px;
        display: grid;
        place-items: center;
        background: #fff;
        border: 1px solid var(--border);
        box-shadow: 0 8px 24px rgba(17, 24, 39, 0.08);
        font-size: 20px;
        flex: 0 0 auto;
    }

    .report-title {
        font-weight: 800;
        letter-spacing: -0.3px;
        color: #dc3545;
        line-height: 1.15;
    }

    .report-sub {
        margin-top: 6px;
        font-size: 0.95rem;
    }

    .report-pill {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        padding: 10px 12px;
        border-radius: 999px;
        border: 1px solid var(--border);
        background: #fff;
        box-shadow: 0 8px 18px rgba(17, 24, 39, 0.06);
        color: var(--muted);
        font-weight: 600;
        font-size: 0.9rem;
        user-select: none;
    }

    .report-pill .dot {
        width: 10px;
        height: 10px;
        border-radius: 99px;
        background: #22c55e;
        box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.18);
    }

    /* ===== KPI cards ===== */
    .kpi-card {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 18px;
        box-shadow: var(--shadow);
        overflow: hidden;
        transition: transform .18s ease, box-shadow .18s ease;
    }

    .kpi-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow2);
    }

    .kpi-top {
        padding: 14px 16px;
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        gap: 12px;
        border-bottom: 1px dashed rgba(17, 24, 39, 0.10);
    }

    .kpi-head {
        display: flex;
        align-items: center;
        gap: 12px;
        min-width: 0;
    }

    .kpi-badge {
        width: 40px;
        height: 40px;
        border-radius: 14px;
        display: grid;
        place-items: center;
        background: rgba(17, 24, 39, 0.04);
        border: 1px solid var(--border);
        flex: 0 0 auto;
        font-size: 18px;
    }

    .kpi-title {
        font-weight: 800;
        letter-spacing: -0.2px;
        font-size: 1.05rem;
        line-height: 1.2;
    }

    .kpi-desc {
        font-size: 0.9rem;
        color: var(--muted);
        margin-top: 2px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 260px;
    }

    .kpi-chip {
        padding: 8px 10px;
        border-radius: 999px;
        font-size: 0.8rem;
        font-weight: 700;
        border: 1px solid var(--border);
        background: rgba(17, 24, 39, 0.03);
        color: var(--muted);
        flex: 0 0 auto;
    }

    .kpi-body {
        padding: 14px 16px 16px 16px;
    }

    .kpi-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        padding: 8px 0;
    }

    .kpi-label {
        color: var(--muted);
        font-weight: 600;
        font-size: 0.95rem;
    }

    .kpi-value {
        font-weight: 900;
        font-size: 1.15rem;
        letter-spacing: -0.3px;
    }

    .kpi-divider {
        height: 1px;
        background: rgba(17, 24, 39, 0.10);
        margin: 10px 0 12px 0;
    }

    .kpi-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
    }

    .kpi-mini {
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 10px 12px;
        background: rgba(17, 24, 39, 0.02);
    }

    .kpi-mini-label {
        color: var(--muted);
        font-weight: 700;
        font-size: 0.82rem;
        margin-bottom: 4px;
    }

    .kpi-mini-value {
        font-weight: 900;
        font-size: 1.1rem;
    }

    /* Accent borders */
    .kpi-success { border-left: 6px solid rgba(40, 167, 69, 0.75); }
    .kpi-primary { border-left: 6px solid rgba(13, 110, 253, 0.75); }
    .kpi-warning { border-left: 6px solid rgba(255, 193, 7, 0.85); }

    /* ===== Panels ===== */
    .panel-card {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 18px;
        box-shadow: var(--shadow);
        overflow: hidden;
        transition: transform .18s ease, box-shadow .18s ease;
    }

    .panel-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow2);
    }

    .panel-head {
        padding: 14px 16px;
        border-bottom: 1px solid rgba(17, 24, 39, 0.08);
        background: linear-gradient(180deg, rgba(17, 24, 39, 0.03), rgba(17, 24, 39, 0.01));
    }

    .panel-title {
        font-weight: 900;
        letter-spacing: -0.2px;
    }

    .panel-sub {
        margin-top: 4px;
        color: var(--muted);
        font-size: 0.9rem;
    }

    .panel-body {
        padding: 14px 16px 16px 16px;
    }

    /* ===== Switch ===== */
    .report-switch .form-check-input {
        width: 3.1rem;
        height: 1.5rem;
        cursor: pointer;
    }

    .report-switch .form-check-label {
        margin-left: 8px;
        font-weight: 700;
        color: #111827;
        cursor: pointer;
    }

    .hint {
        font-size: 0.92rem;
        color: var(--muted);
        line-height: 1.5;
        border-left: 3px solid rgba(13, 110, 253, 0.35);
        padding-left: 10px;
    }

    @@media (max-width: 576px) {
    .report-header { padding: 12px; }
    .kpi-desc { max-width: 180px; }
    .kpi-grid { grid-template-columns: 1fr; }
}

</style>
