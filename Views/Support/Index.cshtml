@{
    Layout = "~/Views/Shared/_LayoutDriver.cshtml";
    ViewData["Title"] = "H·ªó tr·ª£ t√†i x·∫ø";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" />

<div class="driver-support container-fluid py-4">
    <div class="wrap mx-auto">

        <!-- HERO -->
        <div class="s-hero mb-3">
            <div class="d-flex align-items-center gap-3">
                <div class="s-ic"><i class="bi bi-headset"></i></div>
                <div class="min-w-0">
                    <h2 class="m-0 s-title">H·ªó tr·ª£ t√†i x·∫ø</h2>
                    <div class="s-sub text-muted">
                        G·ª≠i y√™u c·∫ßu h·ªó tr·ª£ nhanh, ch·ªçn v·∫•n ƒë·ªÅ m·∫´u, ∆∞u ti√™n x·ª≠ l√Ω kh·∫©n c·∫•p khi c·∫ßn.
                    </div>
                </div>
            </div>

            <div class="s-badge">
                <span class="live-dot"></span>
                <span>SUPPORT</span>
            </div>
        </div>

        <!-- ALERTS -->
        @if (TempData["Success"] != null)
        {
            <div class="alert alert-success border-0 rounded-4 shadow-sm d-flex align-items-start gap-2 mb-3" role="alert">
                <i class="bi bi-check-circle-fill mt-1"></i>
                <div class="min-w-0">
                    <div class="fw-bold">G·ª≠i th√†nh c√¥ng</div>
                    <div>@TempData["Success"]</div>
                </div>
                <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert"></button>
            </div>
        }
        @if (TempData["Error"] != null)
        {
            <div class="alert alert-danger border-0 rounded-4 shadow-sm d-flex align-items-start gap-2 mb-3" role="alert">
                <i class="bi bi-exclamation-triangle-fill mt-1"></i>
                <div class="min-w-0">
                    <div class="fw-bold">C√≥ l·ªói</div>
                    <div>@TempData["Error"]</div>
                </div>
                <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert"></button>
            </div>
        }

        <!-- QUICK CHOICES -->
        <div class="cardx mb-3">
            <div class="cardx-head">
                <div class="fw-bold">
                    <i class="bi bi-lightning-charge me-2"></i> Ch·ªçn nhanh v·∫•n ƒë·ªÅ
                </div>
                <div class="text-muted small">Ch·∫°m 1 l·∫ßn ƒë·ªÉ t·ª± ƒëi·ªÅn n·ªôi dung</div>
            </div>

            <div class="cardx-body">
                <div class="chips">
                    <button type="button" class="chip quick-btn" data-template="M·∫•t ƒë∆°n h√†ng: ">
                        <i class="bi bi-box-seam me-1"></i> M·∫•t ƒë∆°n h√†ng
                    </button>

                    <button type="button" class="chip quick-btn" data-template="GPS kh√¥ng ho·∫°t ƒë·ªông: ">
                        <i class="bi bi-geo-alt me-1"></i> GPS kh√¥ng ho·∫°t ƒë·ªông
                    </button>

                    <button type="button" class="chip quick-btn" data-template="Kh√¥ng li√™n h·ªá ƒë∆∞·ª£c kh√°ch: ">
                        <i class="bi bi-telephone-x me-1"></i> Kh√¥ng li√™n h·ªá ƒë∆∞·ª£c kh√°ch
                    </button>

                    <button type="button" class="chip quick-btn" data-template="Sai ƒë·ªãa ch·ªâ giao h√†ng: ">
                        <i class="bi bi-signpost-2 me-1"></i> Sai ƒë·ªãa ch·ªâ giao h√†ng
                    </button>

                    <button type="button" class="chip quick-btn" data-template="S·ª± c·ªë giao h√†ng: ">
                        <i class="bi bi-cone-striped me-1"></i> S·ª± c·ªë giao h√†ng
                    </button>

                    <button type="button" class="chip quick-btn" data-template="Khi·∫øu n·∫°i ph√≠: ">
                        <i class="bi bi-cash-coin me-1"></i> Khi·∫øu n·∫°i ph√≠
                    </button>

                    <button type="button" class="chip chip-danger quick-btn" data-template="üö® H·ªó tr·ª£ kh·∫©n c·∫•p: ">
                        <i class="bi bi-exclamation-octagon me-1"></i> H·ªó tr·ª£ kh·∫©n c·∫•p
                    </button>
                </div>

                <div class="tip mt-3">
                    <i class="bi bi-info-circle"></i>
                    <div class="min-w-0">
                        <div class="fw-bold">G·ª£i √Ω n·ªôi dung</div>
                        <div class="text-muted small">
                            H√£y cung c·∫•p: m√£ ƒë∆°n (NF-...), v·ªã tr√≠ hi·ªán t·∫°i, m√¥ t·∫£ s·ª± c·ªë, ·∫£nh/ƒë√≠nh k√®m n·∫øu c√≥.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- FORM -->
        <div class="cardx mb-3">
            <div class="cardx-head">
                <div class="fw-bold">
                    <i class="bi bi-envelope-paper me-2"></i> N·ªôi dung y√™u c·∫ßu h·ªó tr·ª£
                </div>
                <div class="text-muted small">Ph·∫£n h·ªìi trung b√¨nh 5‚Äì10 ph√∫t</div>
            </div>

            <div class="cardx-body">
                <form asp-action="Create" asp-controller="Support" method="post" id="supportForm">
                    @Html.AntiForgeryToken()

                    <div class="mb-2">
                        <label class="form-label fw-bold mb-1">Tin nh·∫Øn</label>
                        <textarea class="form-control input-soft p-3"
                                  name="message"
                                  id="supportMessage"
                                  rows="5"
                                  placeholder="Nh·∫≠p n·ªôi dung h·ªó tr·ª£... (VD: NF-2025-000123, kh√°ch kh√¥ng nghe m√°y, ƒëang ƒë·ª©ng t·∫°i ...)"
                                  style="resize:none;"></textarea>

                        <div class="d-flex justify-content-between align-items-center mt-2">
                            <small class="text-muted">
                                <i class="bi bi-shield-check me-1"></i> N·ªôi dung ƒë∆∞·ª£c l∆∞u ƒë·ªÉ ƒë·ªëi so√°t v√† ph·∫£n h·ªìi
                            </small>
                            <small class="text-muted">
                                <span id="charCount">0</span>/600
                            </small>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-soft w-100 py-3 fw-bold" id="btnSubmit">
                        <i class="bi bi-send-fill me-2"></i> G·ª≠i y√™u c·∫ßu
                    </button>

                    <div class="mt-2 text-muted small">
                        B·∫±ng c√°ch g·ª≠i y√™u c·∫ßu, b·∫°n x√°c nh·∫≠n th√¥ng tin cung c·∫•p l√† ch√≠nh x√°c theo t√¨nh hu·ªëng th·ª±c t·∫ø.
                    </div>
                </form>
            </div>
        </div>

        <!-- HISTORY -->
        <div class="cardx">
            <div class="cardx-body">
                <a href="/Support/History" class="btn btn-outline-dark btn-soft w-100 py-2 fw-bold">
                    <i class="bi bi-journal-text me-2"></i> Nh·∫≠t k√Ω h·ªó tr·ª£ & ph·∫£n h·ªìi
                </a>
            </div>
        </div>

    </div>
</div>

<script>
    // Auto fill template
    const textarea = document.getElementById("supportMessage");
    const charCount = document.getElementById("charCount");
    const btnSubmit = document.getElementById("btnSubmit");

    function updateCount() {
        const n = (textarea?.value || "").length;
        if (charCount) charCount.textContent = n.toString();
        if (btnSubmit) btnSubmit.disabled = (n === 0);
    }

    document.querySelectorAll(".quick-btn").forEach(btn => {
        btn.addEventListener("click", () => {
            const tpl = btn.getAttribute("data-template") || (btn.innerText + ": ");
            if (!textarea) return;
            textarea.value = tpl;
            textarea.focus();
            updateCount();
        });
    });

    // Basic client-side guard
    if (textarea) {
        textarea.setAttribute("maxlength", "600");
        textarea.addEventListener("input", updateCount);
        updateCount();
    }

    // Prevent empty submit
    document.getElementById("supportForm")?.addEventListener("submit", function (e) {
        const msg = (textarea?.value || "").trim();
        if (!msg) {
            e.preventDefault();
            textarea?.focus();
        }
    });
</script>

<style>
    .driver-support{
        --border: rgba(17,24,39,.12);
        --shadow: 0 10px 30px rgba(17,24,39,.08);
        font-family: "Segoe UI", system-ui, -apple-system, Arial, sans-serif;
    }

    .wrap{ max-width: 920px; }

    /* HERO */
    .s-hero{
        padding: 16px 18px;
        border-radius: 18px;
        border: 1px solid var(--border);
        background: linear-gradient(180deg, rgba(13,110,253,.12), rgba(13,110,253,.02));
        box-shadow: var(--shadow);
        display:flex;
        align-items:center;
        justify-content:space-between;
        gap: 14px;
        flex-wrap: wrap;
    }
    .s-ic{
        width: 46px; height: 46px;
        border-radius: 16px;
        display:grid; place-items:center;
        background:#fff;
        border:1px solid var(--border);
        box-shadow: 0 8px 24px rgba(17,24,39,.08);
        font-size: 20px;
        color:#0d6efd;
        flex: 0 0 auto;
    }
    .s-title{
        font-weight: 950;
        letter-spacing: -0.2px;
        color:#0d6efd;
        text-transform: uppercase;
        font-size: 1.2rem;
    }
    .s-sub{ margin-top: 4px; font-size: .95rem; line-height: 1.35; }

    .s-badge{
        display:inline-flex; align-items:center; gap:10px;
        padding: 10px 12px;
        border-radius: 999px;
        border:1px solid var(--border);
        background:#fff;
        box-shadow: 0 8px 18px rgba(17,24,39,.06);
        color:#6b7280;
        font-weight: 900;
        font-size: .85rem;
        letter-spacing: .6px;
        user-select:none;
        white-space: nowrap;
    }
    .live-dot{
        width:10px;height:10px;border-radius:99px;
        background:#22c55e;
        box-shadow: 0 0 0 4px rgba(34,197,94,.18);
        display:inline-block;
    }

    /* Card */
    .cardx{
        border-radius: 18px;
        border: 1px solid var(--border);
        background:#fff;
        box-shadow: var(--shadow);
        overflow:hidden;
    }
    .cardx-head{
        padding: 14px 16px;
        border-bottom: 1px solid rgba(17,24,39,.08);
        background: linear-gradient(180deg, rgba(17,24,39,.03), rgba(17,24,39,.01));
        display:flex;
        justify-content:space-between;
        align-items:center;
        gap: 12px;
        flex-wrap: wrap;
    }
    .cardx-body{ padding: 16px; }

    /* Inputs & Buttons */
    .input-soft{
        border-radius: 14px;
        border: 1px solid rgba(17,24,39,.15);
        box-shadow: 0 6px 18px rgba(17,24,39,.05);
    }
    .btn-soft{ border-radius: 14px; font-weight: 900; }

    /* Chips */
    .chips{
        display:flex;
        flex-wrap: wrap;
        gap: 10px;
    }
    .chip{
        border: 1px solid rgba(13,110,253,.22);
        background: rgba(13,110,253,.06);
        color:#0d6efd;
        border-radius: 999px;
        padding: 10px 12px;
        font-weight: 900;
        transition: .15s ease;
        line-height: 1;
        user-select:none;
    }
    .chip:hover{
        transform: translateY(-1px);
        box-shadow: 0 10px 24px rgba(17,24,39,.10);
        background: rgba(13,110,253,.10);
    }
    .chip:active{ transform: translateY(0); }

    .chip-danger{
        border-color: rgba(220,53,69,.28);
        background: rgba(220,53,69,.10);
        color:#dc3545;
    }
    .chip-danger:hover{
        background: rgba(220,53,69,.14);
    }

    /* Tip */
    .tip{
        display:flex;
        gap: 10px;
        align-items:flex-start;
        border: 1px solid rgba(17,24,39,.10);
        background: rgba(17,24,39,.02);
        border-radius: 16px;
        padding: 12px 12px;
    }
    .tip i{
        color:#0d6efd;
        font-size: 18px;
        margin-top: 1px;
        flex: 0 0 auto;
    }

    @@media (max-width: 576px){
        .s-title{ font-size: 1.05rem; }
        .wrap{ max-width: 100%; }
        .chip{ width: 100%; text-align:left; }
    }
</style>
